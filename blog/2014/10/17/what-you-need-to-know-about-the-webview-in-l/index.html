<!DOCTYPE html><html lang="en"><head>
  <title>What You Need to Know About the WebView in L</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="Description" content="This is the site description"/>
  <meta name="theme-color" content="#565797"/>
<style>p{word-wrap:break-word}</style><style>.c-header{color:var(--platnum);padding:var(--header-padding) var(--page-padding);background:var(--dark-grey)}.c-header__logo svg{width:124px;height:124px;margin:auto}.c-header__logo svg path{fill:var(--white)}</style><style>a{color:inherit}</style><style>pre{overflow-x:auto}</style><style>pre{background-color:var(--dark-grey);padding:var(--pre-padding);border-radius:var(--pre-padding);overflow-x:auto;box-shadow:0 2px 8px var(--drop-shadow)}pre code{padding:0;background:unset}</style><style>.l-default{display:flex;flex-direction:column;min-height:100%}.l-default__main{max-width:var(--page-max-width);margin:0 auto;flex:1;padding:var(--page-padding)}</style><style>.c-footer{display:flex;flex-direction:row;justify-content:center}.c-footer__content{padding:var(--footer-padding)}.c-footer a{text-decoration:none}</style><style>code{padding:0 var(--inline-code-padding);border-radius:var(--inline-code-padding);font-family:var(--code-font-family);background:var(--dark-grey);color:var(--white)}</style><style>svg{display:block}</style><style>img{max-width:100%;height:auto}</style><style>@import url("https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap");body{display:inline;min-height:100%;font-family:var(--body-font-family);background:var(--white);color:var(--dark-grey);margin:0}</style><style>h1{font-weight:400;font-size:2rem}</style><style>h2{font-weight:400;font-size:1.7rem}</style><style>:root{--body-font-family:"Roboto",sans-serif;--code-font-family:"dm",monospace;--default-font-size:18px;--table-cell-padding:8px;--page-padding:24px;--header-padding:64px;--footer-padding:64px;--inline-code-padding:4px;--pre-padding:4px;--page-max-width:800px;--white:#f5f6fa;--dark-grey:#2f3640}html{height:100%;font-size:18px;font-size:var(--default-font-size)}</style></head><body>
<div class="l-default">
  <header class="c-header">
  <a href="/" class="c-header__logo">
    <svg width="1024" height="1024" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M988 36H36V987H988V36ZM0 0V1023H1024V0H0Z" fill="black"></path>
<path d="M834.787 519.358H767.661V590H746.567V430.039H845.664V447.397H767.661V502.109H834.787V519.358Z" fill="black"></path>
<path d="M574.089 447.397H522.673V590H501.689V447.397H450.383V430.039H574.089V447.397Z" fill="black"></path>
<path d="M834.984 821.062H765.661V877.751H846.19V895H744.567V735.039H845.092V752.397H765.661V803.813H834.984V821.062Z" fill="black"></path>
<path d="M575.23 844.243C573.253 861.162 566.991 874.236 556.444 883.464C545.97 892.62 532.018 897.197 514.586 897.197C495.689 897.197 480.528 890.422 469.103 876.873C457.75 863.323 452.074 845.195 452.074 822.49V807.109C452.074 792.241 454.71 779.167 459.984 767.888C465.331 756.609 472.875 747.966 482.616 741.96C492.357 735.881 503.636 732.842 516.454 732.842C533.446 732.842 547.069 737.603 557.323 747.124C567.577 756.572 573.546 769.683 575.23 786.455H554.027C552.196 773.711 548.204 764.482 542.052 758.77C535.973 753.057 527.44 750.2 516.454 750.2C502.977 750.2 492.394 755.181 484.703 765.142C477.086 775.103 473.277 789.275 473.277 807.659V823.149C473.277 840.508 476.903 854.314 484.154 864.568C491.405 874.822 501.549 879.949 514.586 879.949C526.305 879.949 535.277 877.312 541.502 872.039C547.801 866.692 551.976 857.427 554.027 844.243H575.23Z" fill="black"></path>
<path d="M266.397 853.252H199.38L184.329 895H162.576L223.66 735.039H242.117L303.311 895H281.668L266.397 853.252ZM205.752 835.894H260.135L232.889 761.077L205.752 835.894Z" fill="black"></path>
<path d="M294.004 590H272.8L192.271 466.733V590H171.067V430.039H192.271L273.02 553.855V430.039H294.004V590Z" fill="black"></path>
<path d="M848.177 122.039V230.804C848.104 245.892 843.343 258.233 833.895 267.828C824.52 277.422 811.775 282.806 795.662 283.978L790.059 284.197C772.554 284.197 758.602 279.473 748.201 270.025C737.801 260.577 732.527 247.576 732.381 231.023V122.039H753.255V230.364C753.255 241.937 756.441 250.945 762.813 257.391C769.185 263.763 778.267 266.949 790.059 266.949C801.998 266.949 811.116 263.763 817.415 257.391C823.787 251.019 826.973 242.046 826.973 230.474V122.039H848.177Z" fill="black"></path>
<path d="M545.897 240.252H478.88L463.829 282H442.076L503.16 122.039H521.617L582.811 282H561.168L545.897 240.252ZM485.252 222.894H539.635L512.389 148.077L485.252 222.894Z" fill="black"></path>
<path d="M292.17 261.016C286.75 268.78 279.169 274.603 269.428 278.484C259.76 282.293 248.481 284.197 235.59 284.197C222.553 284.197 210.981 281.158 200.874 275.079C190.766 268.926 182.929 260.21 177.363 248.931C171.87 237.652 169.05 224.578 168.903 209.71V195.757C168.903 171.661 174.506 152.984 185.712 139.727C196.992 126.47 212.812 119.842 233.173 119.842C249.873 119.842 263.312 124.126 273.493 132.696C283.674 141.192 289.899 153.277 292.17 168.951H271.076C267.121 147.784 254.523 137.2 233.283 137.2C219.147 137.2 208.417 142.181 201.093 152.142C193.842 162.029 190.18 176.385 190.107 195.208V208.282C190.107 226.226 194.208 240.508 202.412 251.128C210.615 261.675 221.711 266.949 235.7 266.949C243.61 266.949 250.532 266.07 256.464 264.312C262.397 262.554 267.304 259.588 271.186 255.413V219.488H234.162V202.349H292.17V261.016Z" fill="black"></path>
</svg>

  </a>
</header>
  <main class="l-default__main">
<p><img src="/images/blog/2014/10/17/lollipop-2200.png" alt="Key art for blog post “What You Need to Know About the WebView in L “"/></p>
<h1 id="what-you-need-to-know-about-the-webview-in-l">What You Need to Know About the WebView in L</h1>
<h1 id="webview-updated-via-play-store">WebView Updated via Play Store</h1>
<p><img src="/images/blog/2014/10/17/tumblr-lm11bt4oak1qe6xr2.gif" alt="OMG Reaction Gif"/></p>
<p>With the L release, the WebView can be updated by the Play Store, this is a huge achievement!</p>
<h1 id="major-new-features">Major New Features</h1>
<p><img src="/images/blog/2014/10/17/328932a7-4adf-4e9a-8542-cc16ed01b963.png" alt="WebRTC in the WebView" title="400"/></p>
<p>The following features are now supported in the latest WebView:</p>
<ol>
<li>WebRTC (<a href="https://github.com/GoogleChrome/chromium-webview-samples/tree/master/webrtc-example">Full Sample Here</a>)</li>
<li>WebAudio</li>
<li>WebGL</li>
<li>Native support for all web components APIs</li>
</ol>
<h1 id="subtle-behaviour-changes">Subtle Behaviour Changes</h1>
<p>There are a few things that have changed which aren&#39;t obvious at first.</p>
<ol>
<li>
<p>Using wrap_contents has always caused the WebView to ignore <a href="https://developers.google.com/web/fundamentals/layouts/rwd-fundamentals/set-the-viewport?hl=en">viewport meta tags</a>, however <strong>in L, viewports are now taken into account</strong>.</p>
</li>
<li>
<p>To be as secure as possible by default, <strong>third party cookies are now off by default</strong>. If you need to turn them on then you can do so with this little snippet of code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// AppRTC requires third party cookies to work
</span><span style="color:#75715e"></span>CookieManager cookieManager <span style="color:#f92672">=</span> CookieManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
cookieManager<span style="color:#f92672">.</span><span style="color:#a6e22e">setAcceptThirdPartyCookies</span><span style="color:#f92672">(</span>mWebView<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
</code></pre></div></li>
<li>
<p>Fullscreen video has caused a few issues where developers hadn&#39;t properly implemented the callbacks. I&#39;ve put a <a href="https://github.com/GoogleChrome/chromium-webview-samples/tree/master/fullscreen-video-sample">sample up on GitHub</a> to show how the callbacks can be used. This includes when to show / not show the fullscreen button based on whether the callbacks <!-- raw HTML omitted -->onShowCustomView<!-- raw HTML omitted --> and <a href="http://developer.android.com/reference/android/webkit/WebChromeClient.html#onHideCustomView()">onHideCustomView</a> have been implemented or not.</p>
</li>
</ol>
<p><img src="/images/blog/2014/10/17/09894563-e134-4962-9a3a-1de11c2fbf99.png" alt="Fullscreen Video Sample" title="400"/></p>
<h1 id="new-apis">New API&#39;s</h1>
<p>With the release of L, there have been some additional API&#39;s added.</p>
<h2 id="permissions">Permissions</h2>
<p>Web API&#39;s like getUserMedia(), need to have access to the devices Microphone and Camera, which means the WebView needs a permission model to grant or deny these requests.</p>
<p>The key new API to control this is the <a href="http://developer.android.com/reference/android/webkit/WebChromeClient.html#onPermissionRequest(android.webkit.PermissionRequest)">onPermissionRequest() method</a> in WebChromeClient.</p>
<p>Below is a simple example that grants any permission that comes from <a href="http://apprtc-m.appspot.com/">http://apprtc-m.appspot.com/</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">mWebView<span style="color:#f92672">.</span><span style="color:#a6e22e">setWebChromeClient</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> WebChromeClient<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onPermissionRequest</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> PermissionRequest request<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;onPermissionRequest&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        getActivity<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">runOnUiThread</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Runnable<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@TargetApi</span><span style="color:#f92672">(</span>Build<span style="color:#f92672">.</span><span style="color:#a6e22e">VERSION_CODES</span><span style="color:#f92672">.</span><span style="color:#a6e22e">L</span><span style="color:#f92672">)</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>request<span style="color:#f92672">.</span><span style="color:#a6e22e">getOrigin</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;https://apprtc-m.appspot.com/&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    request<span style="color:#f92672">.</span><span style="color:#a6e22e">grant</span><span style="color:#f92672">(</span>request<span style="color:#f92672">.</span><span style="color:#a6e22e">getResources</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                    request<span style="color:#f92672">.</span><span style="color:#a6e22e">deny</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
</code></pre></div><p><strong>Note:</strong> Your native app needs the AndroidManifest permissions before it can grant permission forward to a WebView.</p>
<p>The above was taken from the <a href="https://github.com/GoogleChrome/chromium-webview-samples/tree/master/webrtc-example">WebRTC sample on GitHub</a>.</p>
<h2 id="file-upload-api">File Upload API</h2>
<p><img src="/images/blog/2014/10/17/b6ef89db-32fd-42ee-8e6d-6c81af3a3a6a.png" alt="Input File Sample App" title="400"/></p>
<p>A long standing feature request has been for support of the input field for files.</p>
<p>In L, we&#39;ve added the [onShowFileChooser() method](<a href="http://developer.android.com/reference/android/webkit/WebChromeClient.html#onShowFileChooser(android.webkit.WebView,">http://developer.android.com/reference/android/webkit/WebChromeClient.html#onShowFileChooser(android.webkit.WebView,</a> android.webkit.ValueCallback&lt;android.net.Uri[]&gt;, android.webkit.WebChromeClient.FileChooserParams)). This gets called when an input field is clicked and you can show a file selection UI as a result of this.</p>
<p>You can find <a href="https://github.com/GoogleChrome/chromium-webview-samples/tree/master/input-file-example">a full demo application here</a>.</p>
<p>Below is an example implementation of the onShowFileChooser() method which sets up an Intent chooser to take a photo or get an existing image from the gallery.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">mWebView<span style="color:#f92672">.</span><span style="color:#a6e22e">setWebChromeClient</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> WebChromeClient<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">onShowFileChooser</span><span style="color:#f92672">(</span>
      WebView webView<span style="color:#f92672">,</span> ValueCallback<span style="color:#f92672">&lt;</span>Uri<span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">&gt;</span> filePathCallback<span style="color:#f92672">,</span>
      WebChromeClient<span style="color:#f92672">.</span><span style="color:#a6e22e">FileChooserParams</span> fileChooserParams<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

    <span style="color:#75715e">// Double check that we don&#39;t have any existing callbacks
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>mFilePathCallback <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        mFilePathCallback<span style="color:#f92672">.</span><span style="color:#a6e22e">onReceiveValue</span><span style="color:#f92672">(</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    mFilePathCallback <span style="color:#f92672">=</span> filePathCallback<span style="color:#f92672">;</span>

    <span style="color:#75715e">// Set up the take picture intent
</span><span style="color:#75715e"></span>    Intent takePictureIntent <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Intent<span style="color:#f92672">(</span>MediaStore<span style="color:#f92672">.</span><span style="color:#a6e22e">ACTION_IMAGE_CAPTURE</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>takePictureIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">resolveActivity</span><span style="color:#f92672">(</span>getActivity<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPackageManager</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">// Create the File where the photo should go
</span><span style="color:#75715e"></span>      File photoFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        photoFile <span style="color:#f92672">=</span> createImageFile<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        takePictureIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">putExtra</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;PhotoPath&#34;</span><span style="color:#f92672">,</span> mCameraPhotoPath<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// Error occurred while creating the File
</span><span style="color:#75715e"></span>        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">e</span><span style="color:#f92672">(</span>TAG<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Unable to create Image File&#34;</span><span style="color:#f92672">,</span> ex<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>

      <span style="color:#75715e">// Continue only if the File was successfully created
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>photoFile <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        mCameraPhotoPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;file:&#34;</span> <span style="color:#f92672">+</span> photoFile<span style="color:#f92672">.</span><span style="color:#a6e22e">getAbsolutePath</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        takePictureIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">putExtra</span><span style="color:#f92672">(</span>MediaStore<span style="color:#f92672">.</span><span style="color:#a6e22e">EXTRA_OUTPUT</span><span style="color:#f92672">,</span>
            Uri<span style="color:#f92672">.</span><span style="color:#a6e22e">fromFile</span><span style="color:#f92672">(</span>photoFile<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
        takePictureIntent <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">// Set up the intent to get an existing image
</span><span style="color:#75715e"></span>    Intent contentSelectionIntent <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Intent<span style="color:#f92672">(</span>Intent<span style="color:#f92672">.</span><span style="color:#a6e22e">ACTION_GET_CONTENT</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    contentSelectionIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">addCategory</span><span style="color:#f92672">(</span>Intent<span style="color:#f92672">.</span><span style="color:#a6e22e">CATEGORY_OPENABLE</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    contentSelectionIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">setType</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;image/*&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#75715e">// Set up the intents for the Intent chooser
</span><span style="color:#75715e"></span>    Intent<span style="color:#f92672">[</span><span style="color:#f92672">]</span> intentArray<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>takePictureIntent <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      intentArray <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Intent<span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">{</span>takePictureIntent<span style="color:#f92672">}</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
      intentArray <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Intent<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    Intent chooserIntent <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Intent<span style="color:#f92672">(</span>Intent<span style="color:#f92672">.</span><span style="color:#a6e22e">ACTION_CHOOSER</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    chooserIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">putExtra</span><span style="color:#f92672">(</span>Intent<span style="color:#f92672">.</span><span style="color:#a6e22e">EXTRA_INTENT</span><span style="color:#f92672">,</span> contentSelectionIntent<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    chooserIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">putExtra</span><span style="color:#f92672">(</span>Intent<span style="color:#f92672">.</span><span style="color:#a6e22e">EXTRA_TITLE</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Image Chooser&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    chooserIntent<span style="color:#f92672">.</span><span style="color:#a6e22e">putExtra</span><span style="color:#f92672">(</span>Intent<span style="color:#f92672">.</span><span style="color:#a6e22e">EXTRA_INITIAL_INTENTS</span><span style="color:#f92672">,</span> intentArray<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    startActivityForResult<span style="color:#f92672">(</span>chooserIntent<span style="color:#f92672">,</span> INPUT_FILE_REQUEST_CODE<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
</code></pre></div><p>Notice that at the very end we call <strong>startActivityForResult()</strong>, this means we just need the corresponding method <strong>onActivityResult()</strong> where we can call the <a href="http://developer.android.com/reference/android/webkit/ValueCallback.html">filePathCallback.onReceiveValue()</a> once we&#39;ve finished.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onActivityResult</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> requestCode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> resultCode<span style="color:#f92672">,</span> Intent data<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>requestCode <span style="color:#f92672">!</span><span style="color:#f92672">=</span> INPUT_FILE_REQUEST_CODE <span style="color:#f92672">|</span><span style="color:#f92672">|</span> mFilePathCallback <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">onActivityResult</span><span style="color:#f92672">(</span>requestCode<span style="color:#f92672">,</span> resultCode<span style="color:#f92672">,</span> data<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  Uri<span style="color:#f92672">[</span><span style="color:#f92672">]</span> results <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>

  <span style="color:#75715e">// Check that the response is a good one
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>resultCode <span style="color:#f92672">=</span><span style="color:#f92672">=</span> Activity<span style="color:#f92672">.</span><span style="color:#a6e22e">RESULT_OK</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>data <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">// If there is not data, then we may have taken a photo
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>mCameraPhotoPath <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        results <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Uri<span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">{</span>Uri<span style="color:#f92672">.</span><span style="color:#a6e22e">parse</span><span style="color:#f92672">(</span>mCameraPhotoPath<span style="color:#f92672">)</span><span style="color:#f92672">}</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
      String dataString <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">getDataString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>dataString <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        results <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Uri<span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">{</span>Uri<span style="color:#f92672">.</span><span style="color:#a6e22e">parse</span><span style="color:#f92672">(</span>dataString<span style="color:#f92672">)</span><span style="color:#f92672">}</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

  mFilePathCallback<span style="color:#f92672">.</span><span style="color:#a6e22e">onReceiveValue</span><span style="color:#f92672">(</span>results<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  mFilePathCallback <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
  <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>You can find the <a href="https://github.com/GoogleChrome/chromium-webview-samples/tree/master/input-file-example">full sample on GitHub</a>.</p>

</main>
<footer class="c-footer">
  <div class="c-footer__content">
    <a href="://twiter.com/gauntface">Twitter</a> | <a href="://github.com/gauntface">GitHub</a> | <a href="://www.linkedin.com/in/mattgaunt/">LinkedIn</a>
  </div>
</footer>
</div>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-155219449-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155219449-1');
</script>

<script>var haCSS = haCSS || []; haCSS.push(...['/css/elements/code-async.css']);</script></body></html>